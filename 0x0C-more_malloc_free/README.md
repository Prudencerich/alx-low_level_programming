c more functions and more mallocs
